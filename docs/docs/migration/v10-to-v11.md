---
sidebar_position: 1
---

# Migrating from tRPC v10 to v11

This guide covers upgrading nestjs-trpc when moving from tRPC v10 to v11.

## Overview

tRPC v11 is largely backward compatible with v10. The main changes are:

- **Data transformers**: Move to link configuration
- **Client creation**: `createTRPCProxyClient` renamed to `createTRPCClient`
- **SSG helpers**: `createProxySSGHelpers` renamed to `createSSGHelpers`
- **Subscriptions**: New SSE-based subscriptions (WebSocket still supported)

## Required Changes

### 1. Update Dependencies

```bash
# Update your NestJS backend
bun add @trpc/server@^11.0.0

# Update your client (e.g., Next.js frontend)
bun add @trpc/client@^11.0.0 @trpc/server@^11.0.0
```

### 2. Data Transformers (if using)

If you use superjson or other data transformers, move them to link configuration:

**Before (v10):**
```typescript
// In your client
const client = createTRPCProxyClient<AppRouter>({
  transformer: superjson,
  links: [httpBatchLink({ url: '/api/trpc' })],
});
```

**After (v11):**
```typescript
// In your client
const client = createTRPCClient<AppRouter>({
  links: [
    httpBatchLink({
      url: '/api/trpc',
      transformer: superjson,
    }),
  ],
});
```

### 3. Client Creation (if using vanilla client)

**Before (v10):**
```typescript
import { createTRPCProxyClient } from '@trpc/client';
const client = createTRPCProxyClient<AppRouter>({ ... });
```

**After (v11):**
```typescript
import { createTRPCClient } from '@trpc/client';
const client = createTRPCClient<AppRouter>({ ... });
```

Note: The old name still works but is deprecated.

## No Changes Required

These features work identically in v11:

- `@Router()` decorator
- `@Query()` and `@Mutation()` decorators
- `@UseMiddlewares()` decorator
- `@Context()` parameter decorator
- Zod schema validation
- All input/output type inference

## Internal Changes

The following internal implementation changed but requires no user action:

- Router construction now uses plain objects instead of explicit `router()` calls
- This is an internal optimization that aligns with tRPC v11 best practices

## Troubleshooting

### "Cannot find module '@trpc/server'"

Ensure you've updated both server and client packages to v11.

### "Type errors after upgrade"

Clear your TypeScript cache and rebuild:
```bash
rm -rf node_modules/.cache
bun run build
```

### "Transformer not working"

Make sure transformer is in the link options, not the root client options.

## Further Reading

- [Official tRPC v11 Migration Guide](https://trpc.io/docs/migrate-from-v10-to-v11)
- [tRPC v11 Announcement](https://trpc.io/blog/announcing-trpc-v11)
